---
title: "assignment04"
format: 
  html: 
    self-contained: true
editor: visual
author: "Katie Ward and Ben Burnley"
---

## Set-Up

```{r}
#| echo: false
#| message: false
 
library (tidyverse)
library (haven)
data <- read_sav("data/ATP_W101.sav")
```

Our data are from [Pew Research Center's American Trends Panel Wave 101](https://www.pewresearch.org/american-trends-panel-datasets/). This survey asks a battery of traditional political questions and this particular wave focused on political priorities. The survey was in the field January 10 -- January 17, 2022.

\newline

## Chart 1

```{r}
#| code-fold: true
#| code-summary: "Show data cleaning code"

# create data for first chart
chart1data <- data %>%
  filter(F_PARTYSUM_FINAL == 1 | F_PARTYSUM_FINAL == 2 ) %>%
  mutate(parties = case_when(F_PARTYSUM_FINAL == 1 ~"Republican/Lean Repub.", 
                             F_PARTYSUM_FINAL == 2 ~ "Democrat/Lean Dem.", 
                             TRUE~NA_character_)) %>%
  mutate(religiousactivity = case_when(F_ATTEND ==1 ~ "More than once a week", 
                                       F_ATTEND == 2 ~ "Once a week", 
                                       F_ATTEND == 3 ~ "Once or twice a month", 
                                       F_ATTEND ==4 ~ "A few times a year", 
                                       F_ATTEND ==5 ~ "Seldom", 
                                       F_ATTEND ==6 ~ "Never", 
                                       TRUE~NA_character_ ))

# create levels for religious activity variable
rel_levels = c("Never", "Seldom", "A few times a year", "Once or twice a month", "Once a week", "More than once a week")  

# factor the religious activity variable
chart1data <- chart1data %>% 
  mutate(religiousactivity = factor(religiousactivity, levels = rel_levels))
```

```{r}
#| code-fold: true
#| code-summary: "Show code for chart"
#| message: false

chart1 <- chart1data %>% 
  filter(!is.na(religiousactivity)) %>%
  ggplot(aes(religiousactivity, fill=parties)) +
  geom_bar(position = "dodge") +
  scale_fill_manual(values = c("darkblue", "darkred")) +
  coord_flip() +
  theme_minimal() +
  labs(
    title = "Religious Service Attendance by Party Identification",
    subtitle = "Aside from weddings and funerals, how often do you attend religious services?",
    x = "Attendance Level",
    y = "Number of Respondents",
    caption = "Source: Pew Data Center American Trends Panel Wave 101",
    fill = "Party ID"
  ) +
  theme(
    axis.text.x = element_text(angle = 70), 
    legend.position = "bottom",
    plot.title = element_text(face = "bold"),
    plot.subtitle = element_text(face = "italic")
  )

chart1
```

The graph above shows the relationship between party identification and religious service attendance. A large number of the respondents who identify as Democrats report attending religious services "never" or "seldom". For respondents that identify as Republican, there is a greater number that attend more frequently. The difference between the parties is not as large as expected in those who attend religious services once a week to once a month.

\newline

## Chart 2

```{r}

#| code-fold: true
#| code-summary: "Show data cleaning code"

chart2data <- chart1data %>%
  filter(SATIS_W101 != 99) %>%
  mutate(satisfied = ifelse(SATIS_W101==1, 1, 0)) %>%
  mutate(notsatisfied = ifelse(SATIS_W101==2, 1, 0)) %>%
  group_by(parties) %>%
  summarize(satisfied = sum(satisfied), notsatisfied = sum(notsatisfied))

```

```{r}
#| code-fold: true
#| code-summary: "Show code for chart"
#| message: false

chart2 <- chart2data %>%
  ggplot(aes (x = "", y =satisfied, fill=parties)) +
    geom_col() +
      coord_polar("y", start=0) +
        scale_fill_manual(values = c("darkblue", "darkred")) +
          theme (axis.text = element_blank(),axis.ticks = element_blank(), axis.title = element_blank(), plot.subtitle =   element_text(size = 8)) +
            labs(
    title = "Satisfication Rate by Parties",
    subtitle = "Respondents who said they were satisfied with the way things are going in this country." )

chart2
  
```
## Chart 3

```{r}

#| code-fold: true
#| code-summary: "Show data cleaning code"

chart3data <- data %>%
  filter(F_AGECAT != 99) %>%
    mutate(age = case_when(F_AGECAT ==1 ~"18-29", 
                           F_AGECAT==2 ~ "20-49", 
                           F_AGECAT==3 ~ "50-64", 
                           F_AGECAT ==4 ~ "65+", TRUE~NA_character_ )) %>%
  group_by(age) %>%
  summarize(ss = sum(PRIPRES_SC_W101==1, na.rm = TRUE),
            climate = sum(PRIPRES_GCC_W101==1, na.rm = TRUE), 
            crime = sum(PRIPRES_CRI_W101==1, na.rm = TRUE), 
            immigration = sum(PRIPRES_IMM_W101==1, na.rm = TRUE)) %>%
  pivot_longer(cols = 2:5, names_to = "Policy", values_to = "count")

```

```{r}

chart3 <- chart3data %>%
  ggplot(aes(age, count, color=Policy)) +
    geom_point(size = 3) +
    geom_line(aes(group = Policy)) + 
  theme_minimal() +
  theme( plot.subtitle = element_text(size = 8)) +
  labs(
    title = "Top Policy Priorities by Age",
    subtitle = "How many respondents selected various policy priorities by each age group" )

chart3  

```

##Chart 4

```{r}

chart4data <- data %>%
  filter(F_AGECAT != 99) %>%
    mutate(age = case_when(F_AGECAT ==1 ~"18-29", 
                           F_AGECAT==2 ~ "20-49", 
                           F_AGECAT==3 ~ "50-64", 
                           F_AGECAT ==4 ~ "65+", TRUE~NA_character_ )) %>%
  filter(F_PARTYSUM_FINAL == 1 | F_PARTYSUM_FINAL == 2 ) %>%
  mutate(parties = case_when(F_PARTYSUM_FINAL == 1 ~"Republican/Lean Repub.", 
                             F_PARTYSUM_FINAL == 2 ~ "Democrat/Lean Dem.", 
                             TRUE~NA_character_)) 

```

```{r}

chart4 <- chart4data %>%
  ggplot (aes(age, parties, color = parties)) +
    geom_jitter(alpha=0.3) +
  scale_color_manual(values = c("darkblue", "darkred")) +
   theme (axis.text.y = element_blank(), legend.position = "bottom") +
    labs(
    title = "Party Representation by Age",
    subtitle = "Party identification of survey respondents by age group" )

chart4
```